$(document).ready((function(){window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window||navigator.msMaxTouchPoints;var a=!0;const e=algoliasearch("B98TMUO56H","8b48aaf35c4ae7c58ad17cf8f9ea5d9d");if($(".home-search-bar").length){const a=instantsearch({indexName:"CAA-test",searchClient:e,routing:!0,urlSync:!0}),s=instantsearch.widgets.searchBox({container:"#home-search-bar",placeholder:"Search for products",searchAsYouType:!1,showReset:!0,showLoadingIndicator:!0});a.addWidgets([s]),a.start()}if($(".ressources-search-bar").length){const a=instantsearch({indexName:"CAA-test",searchClient:e,routing:!0}),s=instantsearch.widgets.configure({hitsPerPage:8,enablePersonalization:!1}),n=instantsearch.widgets.searchBox({container:"#ressources-search-bar",placeholder:"Search for products",searchAsYouType:!0,showReset:!0,showLoadingIndicator:!0}),t=(a,e)=>{const{hits:s,widgetParams:n,showPrevious:t,isFirstPage:r,showMore:i,isLastPage:o}=a;if(e){const a=document.createElement("div");a.className="card-grid";const e=document.createElement("button"),s=document.createElement("div");return e.className="more-button",e.textContent="Show more",s.className="ressources-results__show-more",e.addEventListener("click",(()=>{i()})),n.container.appendChild(a),s.appendChild(e),void n.container.appendChild(s)}n.container.querySelector(".more-button").disabled=o,n.container.querySelector(".card-grid").innerHTML=`\n            ${s.map((a=>"solutions"===a.postType?`\n                            <div class="card card--rounded card--solution card--yellow">\n                                <a href="${a.url}" class="card__link" title="${a.title}"><span>${a.title}</span></a>\n                                <div class="card-in">\n                                    <header class="card__header">\n                                        <span class="card__type">\n                                            <span class="card__type__icon"></span>\n                                            <span class="card__type__name">${a.postType}</span>\n                                        </span>\n                                    </header>\n                                    <div class="card__main">\n                                        <div class="card__main__top">\n                                            <h2 class="card__title"><span class="card__number">05</span>${a.title}</h2>\n                                        </div>\n                                    </div>\n                                    <footer class="card__footer">\n                                        <ul class="card__tags">\n                                            ${a.areas.map((a=>`<li class="card__tag-item">${a}</li>`)).join("")}\n                                        </ul>\n                                    </footer>\n                                </div>\n                            </div>\n                            `:"experts"===a.postType?`\n                            <div class="card card--expert">\n                                <a href="${a.url}" class="card__link" title="${a.title}"><span>${a.title}</span></a>\n                                <div class="card-in">\n                                    <header class="card__header">\n                                        <span class="card__type">\n                                            <span class="card__type__icon"></span>\n                                            <span class="card__type__name">${a.postType}</span>\n                                        </span>\n                                    </header>\n                                    <div class="card__main">\n                                        <div class="card__main__top">\n                                            <h2 class="card__title">${a.title}</h2>\n                                            <p class="card__sub-title">Fondateur de projet Drawdown</p>\n                                        </div>\n                                        <div class="card__media">\n                                            <div class="card__img">\n                                                <img src="${a.mainImage}" alt="">\n                                                <div class="img-cover" style="background-image: url(${a.mainImage})"></div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <footer class="card__footer">\n                                        <ul class="card__tags">\n                                            ${a.tags.map((a=>`<li class="card__tag-item">${a}</li>`)).join("")}\n                                        </ul>\n                                    </footer>\n                                </div>\n                            </div>`:"areas"===a.postType?`\n                            <div class="card card--field">\n                                <a href="${a.url}" class="card__link" title="${a.title}"><span><${a.title}</span></a>\n                                <div class="card-in">\n                                    <header class="card__header">\n                                        <span class="card__type">\n                                            <span class="card__type__icon"></span>\n                                            <span class="card__type__name">${a.postType}</span>\n                                        </span>\n                                    </header>\n                                    <div class="card__main">\n                                        <div class="card__main__top">\n                                            <h2 class="card__title"><span class="card__number">05</span>${a.title}</h2>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                            `:"post"===a.postType?`\n                            <div class="card card--news">\n                                <a href="${a.url}" class="card__link" title="${a.title}"><span>${a.title}</span></a>\n                                <div class="card-in">\n                                    <header class="card__header">\n                                        <span class="card__type">\n                                            <span class="card__type__icon"></span>\n                                            <span class="card__type__name">actualites</span>\n                                        </span>\n                                        <span class="card__time">${a.date}</span>\n                                    </header>\n                                    <div class="card__main">\n                        \n                                        <div class="card__main__top">\n                                            <h2 class="card__title">${a.title}</h2>\n                                            <span class="card__read-more">Lire plus</span>\n                                        </div>\n                        \n                                    </div>\n                                    <footer class="card__footer">\n                                        <ul class="card__tags">\n                                            ${a.areas.map((a=>`<li class="card__tag-item">${a}</li>`)).join("")}\n                                        </ul>\n                                    </footer>\n                                </div>\n                            </div>`:"partners"===a.postType?`\n                            <div class="card card--partner">\n                                <a href="${a.url}" class="card__link" title="${a.title}"><span>${a.title}</span></a>\n                                <div class="card-in">\n                                    <header class="card__header">\n                                        <span class="card__type">\n                                            <span class="card__type__icon"></span>\n                                            <span class="card__type__name">${a.postType}</span>\n                                        </span>\n                                    </header>\n                                    <div class="card__main">\n                                        <div class="card__main__top">\n                                            <h2 class="card__title">${a.title}</h2>\n                                            <p class="card__sub-title">On the ground in over 90 countries - neutral, impartial, and independent - we are the International Committee of the Red Cross.</p>\n                                        </div>\n                                        <div class="card__media">\n                                            <div class="card--partner__logo">\n                                                <img src="${a.partnerInfo.logoUrl}" alt="${a.title}">\n                                            </div>\n                                            <div class="card__img">\n                                                <img src="${a.mainImage}" alt="">\n                                                <div class="img-cover" style="background-image: url(${a.mainImage})"></div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <footer class="card__footer">\n                                        <ul class="card__tags">\n                                            ${a.sectors.map((a=>`<li class="card__tag-item">${a}</li>`)).join("")}\n                                        </ul>\n                                    </footer>\n                                </div>\n                            </div>`:`<h3>${a.postType} : ${a.title}</h3>`)).join("")}\n            `},r=instantsearch.connectors.connectInfiniteHits(t),i=instantsearch.widgets.refinementList({container:".ref-list__list--areas",attribute:"areas",sortBy:["name:asc"],limit:1e3}),o=instantsearch.widgets.refinementList({container:".ref-list__list--sectors",attribute:"sectors",sortBy:["name:asc"],limit:1e3}),c=instantsearch.widgets.refinementList({container:".ref-list__list--post-type",attribute:"postType",sortBy:["name:asc"],limit:1e3}),d=instantsearch.widgets.currentRefinements({container:".current-filters"}),l=instantsearch.widgets.clearRefinements({container:".clear-all",templates:{resetLabel:"Clear refinements"}});a.addWidgets([s,n,i,o,c,d,l,r({container:document.querySelector(".ressources-results")})]),a.start()}var s,n,t,r,i=(s=function(){var a=$(".top-bar");topBarH=a.outerHeight(!0)+a.position().top,document.documentElement.style.setProperty("--top-bar-h",topBarH+"px")},n=350,function(){var a=this,e=arguments,i=function(){r=null,t||s.apply(a,e)},o=t&&!r;clearTimeout(r),r=setTimeout(i,n),o&&s.apply(a,e)});i(),ScrollTrigger.create({trigger:".header",start:"top -40%",end:99999,onEnter:a=>{$(".top-bar").addClass("top-bar--small"),i()},onLeaveBack:a=>{$(".top-bar").removeClass("top-bar--small"),i()}}),$(".top-bar__sub").length&&ScrollTrigger.create({trigger:".header",start:()=>"bottom 152px",end:99999,onEnter:a=>{$(".top-bar__sub").addClass("top-bar__sub--is-visible"),i()},onLeaveBack:a=>{$(".top-bar__sub").removeClass("top-bar__sub--is-visible"),i()}}),$(".color-mode__button").on("click",(function(e){e.preventDefault(),a?($("body").addClass("dark-mode"),$(this).removeClass("color-mode__button--light").addClass("color-mode__button--dark"),a=!1):($("body").removeClass("dark-mode"),$(this).removeClass("color-mode__button--dark").addClass("color-mode__button--light"),a=!0)})),Marquee3k.init({selector:"news-bar__marquee"}),Marquee3k.refreshAll(),$(".side-nav a").on("click",(function(a){a.preventDefault();var e=$(this).attr("href");gsap.to(window,{duration:1,scrollTo:{y:e,offsetY:150},ease:Power3.easeOut})})),$(".article .block[id]").each((function(){var a=$(this).attr("id"),e=$('.side-nav__link[href="#'+a+'"]');ScrollTrigger.create({trigger:$(this),start:()=>"top 152px",end:"1000000px",toggleClass:{targets:e,className:"side-nav__link--is-active"},onEnter:function(){if(e.parent("li").length){var a=e.parent("li").position().top+e.parent("li").outerHeight(!0);gsap.to(".side-nav__list",{"--h":a+"px",duration:.5})}},onLeaveBack:function(){if(e.parent("li").length){var a=e.parent("li").position().top;gsap.to(".side-nav__list",{"--h":a+"px",duration:.5})}}})})),$(".stats-slider").each((function(){$(this).flickity({cellAlign:"left",contain:!0,prevNextButtons:!1,pageDots:!1})})),$(".timeline-slider").flickity({cellAlign:"left",contain:!0,prevNextButtons:!1,pageDots:!1,freeScroll:!0}).on("scroll.flickity",(function(a,e){e=gsap.utils.clamp(0,1,e),console.log(100*e),gsap.set(".timeline-slider",{"--position":100*e+"%"})})),$(".dropdown__trigger").on("click",(function(){var a=$(this).parents(".dropdown"),e=a.hasClass("dropdown--is-closed"),s=a.find(".dropdown__content"),n=s.find(">div").outerHeight(!0);e?($(".dropdown").removeClass("dropdown--is-open").addClass("dropdown--is-closed"),gsap.to($(".dropdown__content"),1,{height:0,ease:Expo.easeInOut}),gsap.to(s,1,{height:n+"px",ease:Expo.easeInOut,onComplete:function(){gsap.set(s,{height:"auto"}),ScrollTrigger.refresh()}}),$(this).parents(".dropdown").removeClass("dropdown--is-closed").addClass("dropdown--is-open")):(gsap.to(s,1,{height:0,ease:Expo.easeInOut,onComplete:function(){ScrollTrigger.refresh()}}),$(this).parents(".dropdown").removeClass("dropdown--is-open").addClass("dropdown--is-closed"))})),gsap.from(".footer__contact",{yPercent:100,scale:.95,scrollTrigger:{trigger:".footer",start:"top bottom",end:"bottom bottom",scrub:.1,immediateRender:!1}})}));